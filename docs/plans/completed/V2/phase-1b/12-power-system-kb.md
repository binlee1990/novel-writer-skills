# Task 12: 新增 `power-system.md` 知识库

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** 创建力量体系设计知识库，涵盖体系设计原则、平衡性、战力标准化、常见体系模板、崩坏预防

**Architecture:** 在 `templates/knowledge-base/craft/` 目录下新建 `power-system.md`。与 `xuanhuan.md`（类型知识库）互补：`xuanhuan.md` 侧重玄幻类型的整体创作，`power-system.md` 侧重力量体系的通用设计方法论（适用于玄幻、科幻、奇幻等所有含力量体系的类型）。

**Tech Stack:** Markdown 知识库

---

### Task 12.1: 创建 power-system.md

**Files:**
- Create: `templates/knowledge-base/craft/power-system.md`

**Step 1: 创建文件**

```markdown
# 力量体系设计 (Power System Design)

## 快速参考

### 核心定义

**力量体系**：故事世界中超自然/超常规能力的运作规则。包括能力来源、等级划分、使用限制、成长路径。

**适用类型**：玄幻、修仙、奇幻、科幻、超能力、游戏文——任何包含非现实能力的故事。

### 设计三原则

```
1. 一致性 > 创意：体系可以简单，但必须前后一致
2. 限制 > 能力：限制比能力更重要，限制创造冲突
3. 具象 > 抽象：读者能想象的力量才有冲击力
```

---

## 力量体系设计框架

### 第一步：确定体系类型

| 类型 | 特点 | 适用 | 示例 |
|------|------|------|------|
| 硬体系 | 规则明确、逻辑严密 | 升级流、战斗流 | 境界修炼、魔法等级 |
| 软体系 | 规则模糊、重在氛围 | 文学向、氛围向 | 《指环王》的魔法 |
| 混合体系 | 核心规则明确，边缘模糊 | 大多数网文 | 主角体系硬，世界体系软 |

**选择建议**：
- 网文（尤其升级流）→ 硬体系或混合体系
- 文学向 → 软体系或混合体系
- 战斗为核心卖点 → 必须硬体系

### 第二步：设计能力来源

**能力来源决定了体系的「世界观味道」**：

| 来源 | 味道 | 典型设定 |
|------|------|---------|
| 天地灵气 | 东方修仙 | 吸收灵气修炼，境界突破 |
| 魔力/法力 | 西方奇幻 | 魔法学院，咒语体系 |
| 血脉/基因 | 超能力 | 天生能力，觉醒变异 |
| 科技 | 科幻 | 机甲、纳米、基因改造 |
| 信仰/神力 | 神话 | 神赐力量，信仰之力 |
| 规则/法则 | 高武 | 领悟天地法则，掌控规则 |
| 混合 | 复合 | 多种来源并存 |

**设计要点**：
- 来源必须有「获取门槛」（不是所有人都能修炼）
- 来源必须有「上限暗示」（灵气枯竭、血脉稀释、科技瓶颈）
- 来源最好与世界观绑定（灵气来自远古大能陨落 → 世界观深度）

### 第三步：设计等级体系

#### 等级数量建议

| 故事长度 | 建议大境界数 | 建议小境界数 | 总等级数 |
|---------|------------|------------|---------|
| 短篇（< 10 万字） | 3-4 | 无 | 3-4 |
| 中篇（10-50 万字） | 5-7 | 每大境界 3 级 | 15-21 |
| 长篇（50-200 万字） | 7-9 | 每大境界 3-4 级 | 21-36 |
| 超长篇（200 万+） | 9-12 | 每大境界 3-4 级 | 27-48 |

#### 等级设计模板

每个等级必须定义：

```
等级名称：[名称]
━━━━━━━━━━━━━━━━━━━━
能力特征：[这个等级能做什么]
能力上限：[这个等级做不到什么]
标志性表现：[读者一看就知道是这个等级的特征]
社会地位：[在世界中的地位]
稀有度：[世界中有多少这个等级的人]
突破条件：[从上一级突破到这一级需要什么]
突破难度：[成功率/所需时间]
```

#### 等级差距设计

**核心问题**：相邻等级的差距有多大？

| 差距模式 | 描述 | 适用 |
|---------|------|------|
| 线性差距 | 每升一级，实力增加固定比例 | 早期等级 |
| 指数差距 | 越高级差距越大 | 中后期等级 |
| 质变差距 | 某些等级之间是质的飞跃 | 大境界之间 |

**推荐**：小境界之间线性差距，大境界之间质变差距。

### 第四步：设计限制系统

**限制是力量体系的灵魂。没有限制的力量 = 没有冲突。**

#### 五种限制类型

| 限制类型 | 描述 | 示例 |
|---------|------|------|
| 资源限制 | 使用能力需要消耗资源 | 灵力耗尽、弹药用完 |
| 时间限制 | 能力有冷却或持续时间 | 变身只能维持 10 分钟 |
| 条件限制 | 能力需要特定条件才能使用 | 需要咏唱、需要特定材料 |
| 代价限制 | 使用能力有副作用 | 透支生命力、失去记忆 |
| 规则限制 | 能力有内在规则约束 | 等价交换、因果律 |

**设计原则**：
- 每种能力至少有 2 种限制
- 越强的能力，限制越严格
- 限制必须在故事中被「执行」（不能设定了限制又不遵守）

### 第五步：设计成长路径

#### 成长方式多样化

不要只有「闭关修炼 → 突破」一种方式：

| 成长方式 | 描述 | 叙事价值 |
|---------|------|---------|
| 修炼积累 | 日常修炼，量变到质变 | 展示毅力，但叙事无聊 |
| 战斗领悟 | 生死战斗中突破 | 紧张刺激，最常用 |
| 机缘获得 | 偶然获得传承/宝物 | 推动探索，但不能太频繁 |
| 顿悟 | 某个瞬间的领悟 | 展示智慧，但难以写好 |
| 融合/吸收 | 吸收他人/他物的力量 | 有争议性，需要代价 |
| 极限突破 | 在绝境中爆发 | 热血，但不能每次都用 |

**建议**：每种成长方式在全书中至少使用 1 次，避免单调。

---

## 战力标准化

### 为什么需要战力标准化

**问题**：写到后期，作者自己都记不清各等级的战力表现，导致战力崩坏。

**解决方案**：建立「战力参照表」，每个等级有明确的能力基准。

### 战力参照表模板

```markdown
## 战力参照表

### 基准能力

| 等级 | 速度 | 力量 | 防御 | 感知 | 特殊能力 |
|------|------|------|------|------|---------|
| 等级 1 | 常人 2 倍 | 碎石 | 刀枪不入 | 10 米 | 无 |
| 等级 2 | 音速 | 碎墙 | 普通法术 | 100 米 | 飞行 |
| 等级 3 | 超音速 | 碎山 | 高级法术 | 1 公里 | 领域 |
| ... | ... | ... | ... | ... | ... |

### 越级战斗条件

| 越级幅度 | 条件 | 代价 |
|---------|------|------|
| 1 小级 | 技巧优势或法宝 | 轻微消耗 |
| 1 大级 | 特殊体质 + 顶级法宝 | 重伤 |
| 2 大级 | 几乎不可能 | 必死 |

### 参照事件

[记录已写章节中的战力表现，作为后续参照]

| 章节 | 事件 | 参战者等级 | 表现 |
|------|------|-----------|------|
| 第 5 章 | 主角 vs 张三 | 等级 1 vs 等级 2 | 主角借助法宝险胜 |
| 第 12 章 | 主角 vs 李四 | 等级 2 vs 等级 2 | 主角技巧取胜 |
```

---

## 常见体系模板

### 模板 1：九境修炼体系（玄幻/修仙）

```
凡人三境：炼体 → 聚气 → 开脉
灵修三境：筑基 → 金丹 → 元婴
天人三境：化神 → 渡劫 → 大乘
（可选）超脱：飞升 / 成仙 / 成神
```

### 模板 2：魔法等级体系（西方奇幻）

```
学徒 → 初级法师 → 中级法师 → 高级法师 → 大法师 → 圣法师 → 传奇法师
```

### 模板 3：超能力觉醒体系

```
潜能者 → 觉醒者（D级）→ C级 → B级 → A级 → S级 → SS级
```

### 模板 4：科技等级体系

```
基础改造 → 标准强化 → 高级强化 → 超级战士 → 生化兵器 → 超越人类
```

**注意**：以上仅为起点模板，必须根据故事需要自定义。直接套用模板会显得缺乏创意。

---

## 战力崩坏预防

### 崩坏的五个信号

1. **同等级战力不一致**：主角在第 10 章苦战等级 3，在第 50 章轻松碾压等级 3
2. **越级战斗通胀**：越级从「奇迹」变成「日常」
3. **配角战力随剧情变化**：同一个配角忽强忽弱
4. **新角色战力与体系矛盾**：新出场的强者能力超出体系上限
5. **等级失去意义**：等级高的打不过等级低的成为常态

### 预防措施

1. **维护战力参照表**：每次战斗后更新
2. **越级战斗必须有「外挂」**：法宝、血脉、秘术，且每次不同
3. **定期回顾**：每写 10 章回顾一次战力表现
4. **配角战力锚定**：给重要配角设定固定的战力参照
5. **使用 `/track` 追踪**：在 tracking 数据中记录战力事件

### 崩坏修复

如果已经发生战力崩坏：
- **轻微崩坏**：通过后续情节解释（"原来他当时隐藏了实力"）
- **中度崩坏**：引入新设定修正（"原来这个等级还分前中后期"）
- **严重崩坏**：承认并在后续保持新的标准（不要反复修正）

---

## 检测清单

### 体系设计完成后检查
- [ ] 能力来源是否明确？
- [ ] 等级划分是否清晰？
- [ ] 每个等级的能力上限是否定义？
- [ ] 限制系统是否完善（至少 2 种限制）？
- [ ] 成长路径是否多样化？
- [ ] 战力参照表是否建立？
- [ ] 越级战斗规则是否设定？

### 每次战斗前检查
- [ ] 双方等级是否明确？
- [ ] 战斗表现是否与等级匹配？
- [ ] 如有越级，是否有合理解释？
- [ ] 战斗结果是否更新到参照表？

### 每卷结束后检查
- [ ] 本卷的战力描写是否与前卷一致？
- [ ] 是否有新的等级/能力引入？如有，是否与体系兼容？
- [ ] 越级战斗的频率是否合理？
```

**Step 2: 验证文件创建**

Run: `ls -la templates/knowledge-base/craft/power-system.md`
Expected: 文件存在

Run: `wc -l templates/knowledge-base/craft/power-system.md`
Expected: 约 250-300 行

**Step 3: Commit**

```bash
git add templates/knowledge-base/craft/power-system.md
git commit -m "feat(kb): add power-system.md craft knowledge base (design framework, combat standardization, collapse prevention)"
```

---

### Task 12.2: 在 keyword-mappings.json 中注册 power-system

**Files:**
- Modify: `templates/config/keyword-mappings.json`（craft-knowledge 部分）

**Step 1: 在 craft-knowledge 中添加 power-system 映射**

在 `hook-design` 条目之后添加：

```json
,
      "power-system": {
        "keywords": ["力量体系", "战力", "境界", "等级", "power system", "combat"],
        "regex": "力量体系|战力|境界|等级|power\\s*system|combat",
        "regex_flags": "i",
        "resources": [
          "templates/knowledge-base/craft/power-system.md"
        ],
        "priority": 1
      }
```

**Step 2: 在 regex-patterns 中添加对应条目**

```json
"power-system": "力量体系|战力|境界|等级",
```

**Step 3: 验证 JSON 格式**

Run: `node -e "JSON.parse(require('fs').readFileSync('templates/config/keyword-mappings.json','utf8')); console.log('Valid JSON')"`
Expected: `Valid JSON`

**Step 4: Commit**

```bash
git add templates/config/keyword-mappings.json
git commit -m "feat(config): add power-system keyword mapping"
```
