# 设计文档：constitution.md 优化

> 日期：2026-02-21
> 状态：已批准

## 问题诊断

当前 `templates/resources/constitution.md`（140 行）存在以下问题：

1. **对 AI 无效** — 内容是面向人类的通用写作建议（"角色要立体"、"文字要精炼"），无法约束 AI 的实际行为
2. **AI 四大失败模式未解决** — 角色同质化、情节套路化、文风AI味重、前后不一致
3. **职责重叠** — 与 anti-ai.md（文风）、style-reference.md（风格）存在重复
4. **内容臃肿** — 包含流程性内容（创作流程4阶段、持续改进），不属于"宪法"
5. **上下文浪费** — 被 /expand 加载时，140 行占用宝贵的上下文预算但不产生效果

## 设计方案：分层宪法（硬约束 + 软指导）

### 核心理念

从"写给人类的通用建议"转变为"写给 AI 的可执行约束"。每条规则必须：
- 可检验：有明确的违规信号
- 可执行：有具体操作方法
- 针对性：解决 AI 的特定失败模式

### 结构设计

```
# 创作宪法

## 硬规则 — 违反即为质量事故
  ### 一、角色区分（反同质化）
  ### 二、情节反套路（反公式化）
  ### 三、一致性校验（反矛盾）
  ### 四、张力维持（反平淡）

## 软指导 — 写作规范
  ### 分段格式
  ### 章节结构
  ### Show not Tell

## 关联文件
```

### 第一层：硬规则（~56 行）

#### 一、角色区分（反同质化）

**规则**：同一场景中的不同角色，对话风格、反应模式、决策逻辑必须可区分。

**违规信号**（出现任一即需修正）：
- 遮住角色名后，无法从对话内容判断说话者
- 两个角色面对同一事件的内心反应用了相似的句式或情绪词
- 配角的对话仅用于推进主角剧情，没有体现自身立场

**执行方法**：
- 写对话前先回顾角色档案中的语言习惯标签
- 每个角色至少有一个标志性的表达方式（口头禅、句式偏好、话题倾向）
- 配角发言时，从该配角的目标出发思考，不从"剧情需要什么"出发

#### 二、情节反套路（反公式化）

**规则**：情节发展必须服从角色逻辑和因果链，禁止套用固定叙事公式。

**违规信号**：
- "误会 → 解释 → 和好"在同一作品中出现超过一次
- 每次冲突都在同一章内解决，缺乏跨章悬念
- 主角遇到危机时总是恰好获得新能力/外援
- 反派智商随剧情需要波动（该精明时精明，该蠢时蠢）
- 配角在危机时刻突然"及时赶到"而没有前置铺垫

**执行方法**：
- 冲突解决必须有成本：主角得到的同时必须失去什么
- 允许角色犯错和失败，不是每次决策都是最优解
- 危机解除必须基于前文已建立的资源（角色能力、道具、人脉）
- 转折前必须有至少 2 处伏笔或暗示

#### 三、一致性校验（反矛盾）

**规则**：所有创作内容必须与已建立的设定、tracking 记录保持一致。

**违规信号**：
- 角色能力/性格与 character-state.json 记录不符
- 世界观规则前后矛盾（如前文说不能飞，后文突然飞了）
- 角色关系状态与 relationships.json 不符（如已决裂的两人突然亲密）
- 时间线冲突（如白天的场景突然变成夜晚）
- 已消耗的资源/道具再次出现

**执行方法**：
- 扩写前必须检查本章出场角色的最新状态
- 涉及世界观规则时回查 specification.md 的设定
- 新增设定细节后必须更新对应 tracking 文件

#### 四、张力维持（反平淡）

**规则**：每个场景必须包含至少一种张力来源。

**张力类型**（任选其一即可）：
- 信息差：读者知道角色不知道的，或反之
- 目标冲突：场景中至少两个角色的即时目标相互矛盾
- 时间压力：角色必须在限制内完成某事
- 内心矛盾：角色的欲望与责任/道德相冲突
- 悬念延续：场景结束时留下未解答的问题

**违规信号**：
- 场景中所有角色目标一致、没有任何对立面
- 连续 3 段以上纯描写/叙述，没有推动任何冲突
- 章节结尾一切圆满解决，没有遗留任何钩子

### 第二层：软指导（~15 行）

#### 分段格式
- 禁止使用"一"、"二"、"三"等数字标记分段（破坏沉浸感）
- 场景转换使用纯空行分段

#### 章节结构
- 开篇 3 段内必须有钩子（悬念、冲突或反常）
- 结尾必须留下至少一个未解决的问题或新的信息
- 每章是一个相对完整的叙事单元，有清晰的场景目标

#### Show not Tell
- 情感通过行为、对话、生理反应表现，不直接命名情绪
  - ❌ 他很愤怒
  - ✅ 他攥紧的拳头微微发抖，指甲掐进掌心
- 角色性格通过决策和行动展现，不通过旁白描述
- 世界观通过角色的日常互动自然展现，不集中灌输

### 关联文件引用

一句话指向 anti-ai.md（文风控制）和 style-reference.md（个性化风格）。

## 删除内容

| 原内容 | 原因 |
|--------|------|
| 核心创作理念 5 条 | 抽象正确但无执行力，已融入硬规则 |
| 写作规范"必须遵循" | 已融入硬规则 |
| 写作规范"应当避免" | 已融入硬规则的违规信号 |
| 文字风格要求 | 与 anti-ai.md 和 style-reference.md 职责重叠 |
| 创作流程 4 阶段 | 流程性内容，属于命令模板的职责 |
| 质量标准 2 节 | 已融入硬规则 |
| 持续改进 2 节 | 面向人类的建议，对 AI 无意义 |

## 实施范围

- 修改文件：`templates/resources/constitution.md`（唯一修改）
- 不修改：anti-ai.md、style-reference.md、命令模板、测试文件
- 预估行数：从 140 行 → ~85 行（信息密度大幅提升）
